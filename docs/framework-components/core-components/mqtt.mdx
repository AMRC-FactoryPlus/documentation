---
sidebar_position: 8
---

# MQTT

export const ComponentOverview = () => (
    <div className="mb-10 mx-auto text-center w-full flex justify-center">
        <div className="p-4 bg-brand-20 dark:bg-brand-90 w-[3vw] flex items-center justify-end dark:text-brand opacity-40" style={{writingMode: "vertical-lr"}}>Identity</div>
        <div className="flex flex-col">
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-brand h-[3vw] opacity-40"></div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 opacity-40 dark:text-white flex-1 mt-2 ml-2 w-[3vw] flex items-center justify-end text-brand" style={{writingMode: "vertical-lr"}}>Authorisation</div>
        </div>
        <div className="grid grid-cols-5 gap-2">
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-brand col-span-full h-[3vw] flex items-center justify-end opacity-40">Identity</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 opacity-40 dark:text-white col-span-full h-[3vw] flex items-center justify-end text-brand">Authorisation</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40 ml-2">Directory</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40">Configuration Store</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40">Manager</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40">Commands</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40">Data Warehouse</div>
            <div className="p-4 bg-brand-80 dark:bg-brand-40 text-white dark:text-brand flex items-center justify-center col-span-full ml-2">MQTT</div>
            <div className="p-4 bg-brand-20 dark:bg-brand-90 dark:text-white text-brand flex items-center justify-center opacity-40 col-span-full ml-2">Edge Agent</div>
        </div>
    </div>
);

[Exec summary]

<OpenSourceExample buttonText={'ACS MQTT Component'} repoUrl={'https://github.com/AMRC-FactoryPlus/hivemq-krb'}></OpenSourceExample>

## Overview

<ComponentOverview></ComponentOverview>

## Discovery

## MQTT Interface

## HTTP Interface

## Permissions

## Well-Known UUIDs

<WellKnownUUID type='Service Function' name='MQTT'
               uuid='feb27ba3-bd2c-4916-9269-79a61ebc4a47'
               description='MQTT Component service function'/>

<WellKnownUUID type='Permission Group' name='MQTT permissions'
    uuid='a637134a-d06b-41e7-ad86-4bf62fde914a'
    description='All MQTT permissions need to be in this group'/>

Any UUIDs created representing MQTT permissions need to be added to this
group in the Authorisation Component, otherwise the MQTT plugin will not be able to
see the ACEs.

<WellKnownUUID type='Application' name='MQTT Permission Template' 
    uuid='1266ddf1-156c-4266-9808-d6949418b185'
    description='Expands a permission recognised by the MQTT plugin to an MQTT ACL'/>

UUIDs representing MQTT permissions need to have a Configuration Store entry of
this type. This entry serves as a template for the MQTT permissions
granted when the given permission UUID is granted in the Authorisation Component.

The entry **MUST** be a JSON object. Keys represent MQTT topics; values
represent the access granted to that topic. Values **MUST** be strings,
as defined below.

Topic names support the normal MQTT `+` and `#` wildcards. In addition,
if any of the percent sequences below appear in the topic name, the
`target` of the relevant ACE will be looked up under the 'Sparkplug
Address' application below. The percent sequence will be expanded to the
relevant property of the entry returned. If there is no such entry the
topic will be ignored (no permission will be granted).

| Sequence | Property |
|---|---|
| `%g` | `group_id` |
| `%n` | `node_id` |

The access granted is specified as a string containing one or more of
the characters below.

| Access | Meaning |
|---|---|
| `r` | Read data published to the given topic. |
| `w` | Publish to the given topic. |
| `s` | Allow subscription to the given topic. |

The `s` code is intended for implementations that distinguish between
'subscribe' and 'read' permissions. A client granted `s` permission
**SHOULD** be allowed to request subscription to the given topic, but
**MUST NOT** be sent packets for that topic unless `r` permission is
also granted.

Not all implementations will implement the `s` permission.
Implementations that do not **MAY** refuse subscription requests for
topics that do not have `r` permission. Currently the ACS HiveMQ plugin
does not implement `s`.

<WellKnownUUID type='Application' name='Sparkplug Address Information'
    uuid='8e32801b-f35a-4cbf-a5c3-2af64d3debd7'
    description='The Sparkplug address used by an object'/>

This Application is described more fully in the Configuration Store
specification.
